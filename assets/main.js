var maputils;(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{exportedForTesting:()=>C});const n={map:null,currentPolygonLayer:null,currentPolygonCoords:null,s2CellsLayerGroup:null,currentS2Cells:null,setCurrentPolygonCoords(e){this.currentPolygonCoords=e.map((e=>({Lat:e.lat,Lng:e.lng}))),this.currentPolygonCoords.reverse()}};let r=function(e){let t=d(e,null,!0),n=!1,r=!1;n=!e.match(/^\s+/),n?isNaN(t[1])||(r=!0):isNaN(t[0])||(r=!0);let a=0;n&&++a,r&&++a;let l=t[a];"IN"===l&&(l=t[a+1]);let s=t.indexOf(l,n?1:0);return 0!==s&&"IN"===t[s-1]||(t.splice(s,0,"IN"),++s),{rrType:l,tokens:t,hasName:n,hasTtl:r,typeIndex:s}},a=function(e){let t={},n=e.length;return t.name=e[0],t.minimum=parseInt(e[n-1],10),t.expire=parseInt(e[n-2],10),t.retry=parseInt(e[n-3],10),t.refresh=parseInt(e[n-4],10),t.serial=parseInt(e[n-5],10),t.rname=e[n-6],t.mname=e[n-7],isNaN(e[1])||(t.ttl=parseInt(e[1],10)),t},l=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],host:n[r-1]};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},s=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],ip:n[r-1]};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},o=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],ip:n[r-1]};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},i=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],alias:n[r-1]};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},u=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],preference:parseInt(n[r-2],10),host:n[r-1]};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},c=function(e,t){let n=e.tokens;const r=n.slice(e.typeIndex+1);e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let a={name:n[0],txt:r.join(" ")};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},m=function(e,t,n){let r=e.tokens;!e.hasName&&t[t.length-1]&&r.unshift(t[t.length-1].name);let a=r.length,l={name:r[0],fullname:r[0]+"."+n,host:r[a-1]};return e.hasTtl&&(l.ttl=parseInt(r[1],10)),l},p=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],target:n[r-1],priority:parseInt(n[r-4],10),weight:parseInt(n[r-3],10),port:parseInt(n[r-2],10)};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},h=function(e,t){let n=e.tokens;const r=n.slice(e.typeIndex+1);e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let a={name:n[0],data:r.join(" ")};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},f=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],flags:parseInt(n[r-3],10),tag:n[r-2],value:n[r-1]};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},g=function(e,t){let n=e.tokens;e.hasName||(t.length?n.unshift(t[t.length-1].name):n.unshift("@"));let r=n.length,a={name:n[0],key_tag:n[r-4],algorithm:n[r-3],digest_type:n[r-2],digest:n[r-1]};return e.hasTtl&&(a.ttl=parseInt(n[1],10)),a},d=function(e,t,n){let r=t||/\s/g,a=!1,l=!1,s=[],o=[],i=e.split("");for(let e=0;e<i.length;++e){let t=i[e],u=t.match(r);"'"!==t||l?'"'!==t||a?a||l||!u?s.push(t):s.length>0&&(o.push(s.join("")),s=[]):(!0===n&&s.push(t),l=!l):(!0===n&&s.push(t),a=!a)}return s.length>0?o.push(s.join("")):t&&o.push(""),o};const y={generate:function(e,t){const n=JSON.parse(JSON.stringify(e));return t=t||"; Zone: {zone}\n; Exported  (yyyy-mm-ddThh:mm:ss.sssZ): {datetime}\n\n{$origin}\n{$ttl}\n\n; SOA Record\n{name} {ttl}\tIN\tSOA\t{mname}{rname}(\n{serial} ;serial\n{refresh} ;refresh\n{retry} ;retry\n{expire} ;expire\n{minimum} ;minimum ttl\n)\n\n; NS Records\n{ns}\n\n; MX Records\n{mx}\n\n; A Records\n{a}\n\n; AAAA Records\n{aaaa}\n\n; CNAME Records\n{cname}\n\n; PTR Records\n{ptr}\n\n; TXT Records\n{txt}\n\n; SRV Records\n{srv}\n\n; SPF Records\n{spf}\n\n; CAA Records\n{caa}\n\n; DS Records\n{ds}\n\n",t=function(e,t){let n="";return void 0!==e&&(n+="$ORIGIN "+e),t.replace("{$origin}",n)}(n.$origin,t),t=function(e,t){let n="";return void 0!==e&&(n+="$TTL "+e),t.replace("{$ttl}",n)}(n.$ttl,t),t=function(e,t){let n=t;return e.name=e.name||"@",e.ttl=e.ttl||"",Object.keys(e).map((t=>{n=n.replace("{"+t+"}",e[t]+"\t")})),n}(n.soa,t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tNS\t"+t.host+"\n";return t.replace("{ns}",n)}(n.ns||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tA\t"+t.ip+"\n";return t.replace("{a}",n)}(n.a||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tAAAA\t"+t.ip+"\n";return t.replace("{aaaa}",n)}(n.aaaa||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tCNAME\t"+t.alias+"\n";return t.replace("{cname}",n)}(n.cname||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tMX\t"+t.preference+"\t"+t.host+"\n";return t.replace("{mx}",n)}(n.mx||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tPTR\t"+t.host+"\n";return t.replace("{ptr}",n)}(n.ptr||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tTXT\t"+t.txt+"\n";return t.replace("{txt}",n)}(n.txt||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tSRV\t"+t.priority+"\t",n+=t.weight+"\t",n+=t.port+"\t",n+=t.target+"\n";return t.replace("{srv}",n)}(n.srv||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+="IN\tSPF\t"+t.data+"\n";return t.replace("{spf}",n)}(n.spf||[],t),t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+=`IN\tCAA\t${t.flags}\t${t.tag}\t${t.value}\n`;return t.replace("{caa}",n)}(n.caa||[],t),(t=function(e,t){return(t=(t=t.replace("{zone}",e.$origin||e.soa.name||"")).replace("{datetime}",(new Date).toISOString())).replace("{time}",Math.round(Date.now()/1e3))}(n,t=function(e,t){let n="";for(let t of e)n+=(t.name||"@")+"\t",t.ttl&&(n+=t.ttl+"\t"),n+=`IN\tDS\t${t.key_tag}\t${t.algorithm}\t${t.digest_type}\t${t.digest}\n`;return t.replace("{ds}",n)}(n.ds||[],t))).replace(/\n{2,}/gim,"\n\n")},parse:function(e){return function(e){let t={},n=e.split("\n");for(let e of n){if(!e.trim())continue;let n=d(e,null,!0);if(e.startsWith("$ORIGIN"))t.$origin=n[1];else if(e.startsWith("$TTL"))t.$ttl=n[1];else{const d=r(e);switch(d.rrType){case"SOA":t.soa=a(n);break;case"TXT":t.txt=t.txt||[],t.txt.push(c(d,t.txt));break;case"NS":t.ns=t.ns||[],t.ns.push(l(d,t.ns));break;case"A":t.a=t.a||[],t.a.push(s(d,t.a));break;case"AAAA":t.aaaa=t.aaaa||[],t.aaaa.push(o(d,t.aaaa));break;case"CNAME":t.cname=t.cname||[],t.cname.push(i(d,t.cname));break;case"MX":t.mx=t.mx||[],t.mx.push(u(d,t.mx));break;case"PTR":t.ptr=t.ptr||[],t.ptr.push(m(d,t.ptr,t.$origin));break;case"SRV":t.srv=t.srv||[],t.srv.push(p(d,t.srv));break;case"SPF":t.spf=t.spf||[],t.spf.push(h(d,t.spf));break;case"CAA":t.caa=t.caa||[],t.caa.push(f(d,t.caa));break;case"DS":t.ds=t.ds||[],t.ds.push(g(d,t.ds))}}}return t}(e=function(e){let t=/SOA[\s\S]*?\([\s\S]*?\)/gim.exec(e);if(null!==t){let n=t[0].replace(/\s+/gm," ");return n=n.replace(/\(|\)/gim," "),e.substring(0,t.index)+n+e.substring(t.index+t[0].length)}return e}(e=function(e){const t=e.split("\n");let n="";for(const e of t){if(e.trim().startsWith(";"))continue;const t=d(e,";",!0);for(const e of t){if(n+=e,!e.endsWith("\\")){n+="\n";break}n+=";"}}return n}(e)))}};function I(e,t){var n=parseInt(e,16).toString(2);n=n.slice(0,n.length-1);var r=parseInt(n.slice(0,3),2).toString(),a=parseInt(n.slice(3),2).toString(4);return(a=a.split("")).reverse(),a.push(r),a.join(".")+"."+t}function v(e){if(!n.currentS2Cells)return alert("Please generate S2 cells first"),null;var t=[];for(let a in n.currentS2Cells){var r=I(a,e);t.push(r)}return t}function S(e){var t=e.dnsSuffix;"."!=t[t.length-1]&&(t+=".");var n=v(t);if(!n)return null;var r=function(e){var t="",n=Math.min(...e.map((e=>e.length)));for(let a=0;a<n;a++){var r=e[0][e[0].length-a-1];if(!e.every((e=>e[e.length-a-1]==r)))break;t=r+t}return t}(n),a={$origin:r=r.slice(1),$ttl:e.TTL,soa:{mname:e.mname,rname:e.rname,serial:parseInt(Date.now()/1e3)%Math.pow(2,32),refresh:e.refresh,retry:e.retry,expire:e.expire,minimum:e.minimum}};a.ns=[{name:"@",host:e.mname}],a.txt=[];for(let t of n){var l=t.slice(0,t.length-r.length-1);a.txt.push({name:l,txt:JSON.stringify({type:e.rrType,data:e.rrData})})}return y.generate(a)}function x(){const e=S({dnsSuffix:document.getElementById("dns-suffix").value,mname:document.getElementById("mname").value,rname:document.getElementById("rname").value,refresh:document.getElementById("refresh").value,retry:document.getElementById("retry").value,expire:document.getElementById("expire").value,minimum:document.getElementById("minimum").value,rrType:document.getElementById("rr-type").value,rrData:document.getElementById("rr-data").value,TTL:document.getElementById("ttl").value});if(!e)return null;const t=document.createElement("a");return t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","dns-zonefile.txt"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),e}!function(){var e=L.map("map").setView([40.44266,-79.94327],17);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(e),e.pm.addControls({drawMarker:!1,drawCircleMarker:!1,drawPolyline:!1,drawRectangle:!1,drawPolygon:!0,drawCircle:!1,drawText:!1});const t=new GeoSearch.OpenStreetMapProvider,r=new GeoSearch.GeoSearchControl({provider:t,style:"bar"});e.addControl(r),e.on("pm:drawstart",(t=>{n.currentPolygonLayer&&(e.removeLayer(n.currentPolygonLayer),n.currentPolygonLayer=null,n.currentPolygonCoords=null),n.s2CellsLayerGroup&&(e.removeLayer(n.s2CellsLayerGroup),n.s2CellsLayerGroup=null,n.currentS2Cells=null)})),e.on("pm:create",(e=>{if("Polygon"===e.shape){const t=e.layer,r=t.getLatLngs()[0];n.setCurrentPolygonCoords(r),n.currentPolygonLayer=t}})),n.map=e}(),document.getElementById("generate-s2-button").addEventListener("click",(()=>{!function(){if(n.currentPolygonCoords){var e=document.getElementById("max-s2-cells").value;if(e){var t=function(e,t){return GetS2CellsInRegion(t,1,30,e)}(e=parseInt(e),n.currentPolygonCoords),r=[];for(let e in t){var a=t[e];a=a.map((e=>[e.Lat,e.Lng]));var l=L.polygon(a,{color:"red",fillOpacity:.1,opacity:.5,weight:2});r.push(l)}n.s2CellsLayerGroup&&n.map.removeLayer(n.s2CellsLayerGroup),n.s2CellsLayerGroup=L.layerGroup(r),n.s2CellsLayerGroup.addTo(n.map),n.currentS2Cells=t}else alert("Please enter a number of cells")}else alert("Please draw a polygon first")}()}));const N=document.getElementById("dns-config-form");N.addEventListener("submit",(e=>{e.preventDefault(),N.checkValidity()?x():N.reportValidity()}));var C={getGeoDomainFromS2CellID:I,getGeoDomainsForCurrentCells:v,generateZoneFile:S,generateZoneFileFromDOM:x,globalState:n};maputils=t})();